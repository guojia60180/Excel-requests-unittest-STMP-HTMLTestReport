# Excel+requests+unittest+STMP接口的单元测试

**目的做一个自动化接口测试的项目**

**case** 存放测试用例

**data** 获取Excel文件相应数据的方法封装，判断用例之间是否有依赖关系

**dataconfig** 存放请求涉及到的header data数据

**log** 存放日志文件

**main** 主函数

**util** 通用方法的封装包含：

                        1.断言方式
                        2.excel文件的读写操作
                        3.依赖关系中的下一个请求从上一个用例上拿数据
                        4.存放日志文件
                        5.json文件使用
                        6.请求类型不同get/post 执行不同方法
                        7.邮件发送 log.txt以附件的方式发送给邮箱

测试用例保存至*/case/interface.xls*中

测试用例中存在依赖选项，有所依赖的case

通过xlrd得到excel中的测试用例

拿取excel中表格中的关键字，再通过关键字去对应json文件拿取具体的请求数据，json文件数据在dataconfig中

拿到请求相关数据后，执行该条case，获取response；然后实际结果与预期结果进行断言

把输出日志存在log文件中

附件发送至用户（授权码 STMP服务器 **SSL方式 465端口**）


###项目亮点：
            
            1.考虑了依赖的使用
            在实际的测试用例中，往往会出现这一个测试用例需要上一个测试用例所返回的结果
            
            2.对xlrd操作excel测试用例的各种方法重新加载
            由于需要查找依赖，因此通过字符串驱动型的方式，通过requests的方式找到关键词，然后通过该关键词找到测试用例的行数，确定测试用例的id
            
            3.发送邮件方面，需要账号的授权码作为密码，需要开启SMTP和POP3服务，通过SSH连接SMTP服务器，attch方法挂载附件
            在这一块还可以优化的方向是通过别的方式，发送邮件